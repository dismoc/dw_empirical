temp$PPPLF_i <- ifelse(temp$PPPLF > 0, 1, 0)
temp$DW_i <- ifelse(temp$DW > 0, 1, 0)
temp$PPP_i <- ifelse(temp$PPP > 0, 1, 0)
sf2 <- left_join(sf2,temp[,c('RSSD','PPPLF_i','DW_i','PPP_i')])
sf2$State <- coalesce(sf2$STATE, sf2$Borrower.state)
#Create series on whether bank has accessed the LF within the past month
t <- aggregate(PPPLF ~ RSSD + Date, sf2, sum) %>% group_by(RSSD) %>% arrange(RSSD, Date)
t <- t %>% group_by(RSSD) %>% mutate(LF_30 = rollapplyr(PPPLF, width = 30, FUN = sum, partial = TRUE))
sf2 <- left_join(sf2,t[,c('RSSD','Date','LF_30')],by=c('RSSD','Date'))
sf2$LF_30 <- sf2$LF_30*100/sf2$Reserves
sf2$LF_30 <- ifelse(is.na(sf2$LF_30) == TRUE, 0, sf2$LF_30)
# Joining all the deposit weighted data
sf2 <- left_join(sf2,binstr,by=c('RSSD'='IDRSSD','Date'))
sf2$covexpo <- ifelse(sf2$covexpo < 0, 0, sf2$covexpo)
sf2$eci <- abs(sf2$eci)
# create series on whether bank has used DW 5 years pre-covid
dwborrow1 <- subset(dwborrow, Loan.date >= '2015-04-03' & Loan.date < '2020-04-03')
ls <- intersect(unique(sf2$ABA),unique(dwborrow1$Borrower.ABA.number))
sf2[sf2$ABA %in% ls, 'precovdw'] <- 1
sf2$precovdw <- ifelse(is.na(sf2$precovdw) == TRUE, 0, 1)
#merging with the covid data
# Making the regression dataset
sf3 <- subset(sf2, Date >= as.Date('2020-04-03') & Date <= as.Date('2020-08-08'))
sf3 <- sf3[!duplicated(sf3[c("RSSD", "Date")]),]
sf3 <- sf3 %>% drop_na(RSSD, Date, State, size_quint)
sf3 <- sf3[!sf3$Reserves == 0,]
sf3 <- sf3[rowSums(is.na(sf3)) != ncol(sf3), ]
sf3 <- subset(sf3, PPP_i == 1)
list <- c('pppsores','dwsores','LF_30','eci','eqcaprat','covexpo','rsa','lsa','dsa','reserve_asset_ratio','ci_com','scisoa','cdep','cisoa','liqass','levrat','size','dwage')
sf3[,list] <- lapply(sf3[,list], Winsorize, probs=c(.01,.99), na.rm = TRUE)
nf1
nf1[,-c('c_instr')]
nf1[,c(-'c_instr')]
nf1[,-10]
nf1 <- nf1[,-10]
temp
temp <- aggregate(DEPSUMBR ~ STALPBR + RSSDID, sod, FUN = sum) %>% group_by(RSSDID)
temp <- temp %>% group_by(RSSDID) %>% mutate(totdep = sum(DEPSUMBR))
temp$depshare <- temp$DEPSUMBR/temp$totdep
temp <- left_join(temp, base, by=c('RSSDID' = 'rssd', 'STALPBR'))
temp
temp$c_instr <- temp$c_instr*temp$depshare
temp <- aggregate(c_instr ~ RSSDID + DateApproved, temp, sum)
hist(temp$c_instr)
descr(temp$c_instr)
temp
nf1 <- left_join(nf1, temp, by=c('IDRSSD' = 'RSSDID','Date' = 'DateApproved'))
nf1$c_instr <- ifelse(is.na(nf1$c_instr) == TRUE, 0, nf1$c_instr)
descr(nf1$c_instr)
descr(sf3$pppsores)
nf1
ls <- subset(df, Date == '2020-03-31')
ls <- unique(data.frame(RSSD = ls$IDRSSD, ABA = ls$Primary.ABA.Routing.Number, STATE = ls$Financial.Institution.State))
sf2 <- data.frame(ls, Date=rep(full_seq(c(as.Date('2020-04-03'),as.Date('2020-08-08')), period=1),5165))
sf2 <- sf2 %>% group_by(RSSD) %>% mutate(Date = full_seq(c(as.Date('2020-04-03'),as.Date('2020-08-08')), period=1))
ls <- unique(smartbind(ls,data.frame(att)))
sf2 <- left_join(sf2,aggregate(cbind(n,InitialApprovalAmount) ~ rssd + DateApproved, pppm, sum), by=c('RSSD'='rssd','Date'='DateApproved'))
sf2$n <- ifelse(is.na(sf2$n) == TRUE, 0, sf2$n)
sf2$InitialApprovalAmount <- ifelse(is.na(sf2$InitialApprovalAmount) == TRUE, 0, sf2$InitialApprovalAmount)
sf2 <- full_join(sf2,
left_join(data.frame(aggregate(Original.Outstanding.Advance.Amount ~ Institution.RSSD + Date.Of.Advance, pplf, sum)),
pplf[,c('Institution.RSSD', 'Date.Of.Advance', 'origin_date')]),
by=c('RSSD' = 'Institution.RSSD', 'Date' = 'Date.Of.Advance'))
#changing terms to overnights
dwborrow1 <- subset(dwborrow, Loan.date >= as.Date('2020-03-01') & Type.of.credit == 'Primary Credit')
dwborrow1 <- dwborrow1[order(dwborrow1$Borrower.ABA.number,dwborrow1$Loan.date),]
dwborrow1$Borrower.ABA.number <- as.numeric(dwborrow1$Borrower.ABA.number)
dwborrow1$term <- as.numeric(dwborrow1$Repayment.date - dwborrow1$Loan.date)
# Changing everything to 1 term loan
dwborrow1 <- dwborrow1[rep(1:nrow(dwborrow1), times=dwborrow1$term), ]
dwborrow1 <- dwborrow1[order(dwborrow1$Borrower.ABA.number,dwborrow1$Loan.date),]
for (i in 2:nrow(dwborrow1)){
if (dwborrow1[i,'term'] > 1 & dwborrow1[i,'Borrower.ABA.number'] == dwborrow1[i-1,'Borrower.ABA.number']) {
dwborrow1[i,'Loan.date'] <- dwborrow1[i-1,'Loan.date']+1
}
}
dwborrow1 <- left_join(aggregate(Loan.amount ~ Borrower.ABA.number + Loan.date, dwborrow1, sum), dwborrow1[,c('Loan.date','Borrower.ABA.number','Loan.amount','Borrower.state')])
sf2 <- full_join(sf2,dwborrow1[,c('Loan.date','Borrower.ABA.number','Loan.amount','Borrower.state')], by=c('ABA' = 'Borrower.ABA.number', 'Date' = 'Loan.date'))
sf2[is.na(sf2$Original.Outstanding.Advance.Amount),c('Original.Outstanding.Advance.Amount')] <- 0
sf2[is.na(sf2$Loan.amount),c('Loan.amount')] <- 0
keep <- c('Date','size','IDRSSD','reserve_asset_ratio','reserve_loan_ratio','RCON2170','RCON0071','RCON0081','RCON2200','eqcaprat','age','borr_total','FED','exposure','OFFICES', 'aq', 'roe','RCONB529',
'RCFA7204','nonppp_loans','RCOA8274','RCOAA224','RCONJ457','RCON5571','RCON5573','RCON5575','RCON2215','RCON2210','RCON1766','RCONJJ34','RCON1773','RCONJA22')
temp <- subset(df, as.Date(Date) >= as.Date('2020-03-31'))[,keep]
temp$Date <- as.Date(temp$Date)
sf2$Quarter <- as.Date(quarter(sf2$Date, type='date_first')-1)
sf2 <- left_join(sf2, temp, by=c('RSSD' = 'IDRSSD','Quarter'='Date'))
setnames(sf2, old=c('InitialApprovalAmount','Original.Outstanding.Advance.Amount', 'Loan.amount'),
new = c('PPP','PPPLF','DW'))
sf2$Reserves <- (sf2$RCON0081 + sf2$RCON0071)*1000
sf2$Assets <- sf2$RCON2170*1000
# From the  Li Strahan 2020 paper
# Relationship measures
sf2$ci_com <- sf2$RCONJ457/sf2$RCON2170
sf2$scisoa  <- (sf2$RCON5571+sf2$RCON5573+sf2$RCON5575)/sf2$RCON2170
sf2$cdep   <- (sf2$RCON2215+sf2$RCON2210)/sf2$RCON2170
#Balance sheet ratio
sf2$cisoa <- sf2$RCON1766/sf2$RCON2170
sf2$levrat <- sf2$RCOA8274/sf2$RCOAA224
sf2$liqass <- rowSums(cbind(sf2$RCON0071,sf2$RCON0081,sf2$RCONJJ34,sf2$RCON1773,sf2$RCONJA22),na.rm=TRUE)/sf2$RCON2170
sf2$scisoa <- ifelse(is.na(sf2$scisoa) == TRUE, 0, sf2$scisoa)
sf2$dwsores <- sf2$DW/sf2$Reserves
sf2$pppsores <- sf2$PPP/sf2$Reserves
sf2$pppsores <- ifelse(is.na(sf2$pppsores) == TRUE, 0, sf2$pppsores)
sf2$lfsores <- sf2$PPPLF/sf2$Reserves
sf2$npplsores <- sf2$nonppp_loans/sf2$Reserves
sf2$dwsoa <- sf2$DW/sf2$RCON2170
sf2$pppsoa <- sf2$PPP/sf2$RCON2170
sf2$pppsoa <- ifelse(is.na(sf2$pppsoa) == TRUE, 0, sf2$pppsoa)
sf2$lfsoa <- sf2$PPPLF/sf2$RCON2170
sf2$dwbin_notest <- ifelse(sf2$dwsores > 0.01, 1,0)
sf2$dwbin_notest <- ifelse(is.na(sf2$dwbin_notest) == TRUE, 0, sf2$dwbin_notest)
sf2$dwsores <- ifelse(sf2$dwbin_notest == 1, sf2$dwsores, 0)
sf2$dw_bin <- ifelse(sf2$DW > 0, 1, 0)
sf2$ppp_ind <- ifelse(sf2$PPP > 0, 1, 0)
sf2$bigsmall <- ifelse(sf2$RCON2170 > 600000, 1, 0)
sf2$dwsores <- sf2$dwsores*100
sf2$pppsores <- sf2$pppsores*100
#sf2$bigsmall <- ifelse(sf2$RCON2170 > 10000000, 2, sf2$bigsmall)
#Creating the PPP active indicator
sf2$PPPLF_ind <- ifelse(sf2$PPPLF > 0, 1, 0)
sf2$r_delt <- -sf2$PPPLF + sf2$PPP
sf2 <- sf2[order(sf2$RSSD,sf2$Date),]
sf2 <- sf2 %>% group_by(RSSD) %>% mutate(cs_ppp = cumsum(PPP), cs_delt = cumsum(r_delt))
#Date FE stuff
sf2$month <- month(sf2$Date)
sf2$week <- as.numeric(floor(1 + (sf2$Date - as.Date('2020-04-03'))/7))
sf2$phase <- ifelse(sf2$Date > as.Date('2020-04-16') & sf2$Date < as.Date('2020-04-27'), 0, 1)
sf2$phase <- ifelse(sf2$Date <= as.Date('2020-04-16'), 1, sf2$phase)
sf2$phase <- ifelse(sf2$Date >= as.Date('2020-04-27'), 2, sf2$phase)
sf2$rsa <- sf2$Reserves/sf2$Assets
sf2$lsa <- sf2$RCONB529/sf2$RCON2170
sf2$dsa <- sf2$RCON2200/sf2$RCON2170
temp <- aggregate(cbind(size,reserve_asset_ratio) ~ RSSD, sf2, mean) %>% mutate(size_quint = ntile(size,4), shock_quint = ntile(reserve_asset_ratio,5))
sf2 <- left_join(sf2, temp[,c('RSSD','size_quint','shock_quint')], by = 'RSSD')
temp <-aggregate(cbind(PPP,DW,PPPLF) ~ RSSD, sf2, sum)
temp$PPPLF_i <- ifelse(temp$PPPLF > 0, 1, 0)
temp$DW_i <- ifelse(temp$DW > 0, 1, 0)
temp$PPP_i <- ifelse(temp$PPP > 0, 1, 0)
sf2 <- left_join(sf2,temp[,c('RSSD','PPPLF_i','DW_i','PPP_i')])
sf2$State <- coalesce(sf2$STATE, sf2$Borrower.state)
#Create series on whether bank has accessed the LF within the past month
t <- aggregate(PPPLF ~ RSSD + Date, sf2, sum) %>% group_by(RSSD) %>% arrange(RSSD, Date)
t <- t %>% group_by(RSSD) %>% mutate(LF_30 = rollapplyr(PPPLF, width = 30, FUN = sum, partial = TRUE))
sf2 <- left_join(sf2,t[,c('RSSD','Date','LF_30')],by=c('RSSD','Date'))
sf2$LF_30 <- sf2$LF_30*100/sf2$Reserves
sf2$LF_30 <- ifelse(is.na(sf2$LF_30) == TRUE, 0, sf2$LF_30)
# Joining all the deposit weighted data
sf2 <- left_join(sf2,binstr,by=c('RSSD'='IDRSSD','Date'))
sf2$covexpo <- ifelse(sf2$covexpo < 0, 0, sf2$covexpo)
sf2$eci <- abs(sf2$eci)
# create series on whether bank has used DW 5 years pre-covid
dwborrow1 <- subset(dwborrow, Loan.date >= '2015-04-03' & Loan.date < '2020-04-03')
ls <- intersect(unique(sf2$ABA),unique(dwborrow1$Borrower.ABA.number))
sf2[sf2$ABA %in% ls, 'precovdw'] <- 1
sf2$precovdw <- ifelse(is.na(sf2$precovdw) == TRUE, 0, 1)
#merging with the covid data
# Making the regression dataset
sf3 <- subset(sf2, Date >= as.Date('2020-04-03') & Date <= as.Date('2020-08-08'))
sf3 <- sf3[!duplicated(sf3[c("RSSD", "Date")]),]
sf3 <- sf3 %>% drop_na(RSSD, Date, State, size_quint)
sf3 <- sf3[!sf3$Reserves == 0,]
sf3 <- sf3[rowSums(is.na(sf3)) != ncol(sf3), ]
sf3 <- subset(sf3, PPP_i == 1)
list <- c('pppsores','dwsores','LF_30','eci','eqcaprat','covexpo','rsa','lsa','dsa','reserve_asset_ratio','ci_com','scisoa','cdep','cisoa','liqass','levrat','size','dwage')
sf3[,list] <- lapply(sf3[,list], Winsorize, probs=c(.01,.99), na.rm = TRUE)
# Table 1 - OLS results (Pooled, Large, small) - w/ and without controls for DW borrowing quantity  SD - (log(7.871206)/log(1.01))----
ta <- list()
ta[[1]] <- feols(dwsores ~ pppsores|FED + Date,
sf3,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
# Table 1 - OLS results (Pooled, Large, small) - w/ and without controls for DW borrowing quantity  SD - (log(7.871206)/log(1.01))----
ta <- list()
ta[[1]] <- feols(dwsores ~ pppsores|FED + Date,
sf3,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
feols(pppsores ~ c_instr, sf3)
# Table 3 - IV Results (Pooled, Large, small) with controls using the daily data ----
ta6 <- list()
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[2]] <- update(ta6[[1]], subset = sf3$bigsmall == 1)
ta6[[1]]
ta6[[2]]
ta6[[3]] <- update(ta6[[1]], subset = sf3$bigsmall == 0)
ta6[[4]] <- update(ta2[[2]], .~. - pppsores | . | pppsores ~ log(n+1))
ta6[[5]] <- update(ta6[[4]], subset = sf3$bigsmall == 1)
ta6[[6]] <- update(ta6[[4]], subset = sf3$bigsmall == 0)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
ta6[[4]] <- update(ta2[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[5]] <- update(ta6[[4]], subset = sf3$bigsmall == 1)
ta6[[6]] <- update(ta6[[4]], subset = sf3$bigsmall == 0)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr) + asinh(n))
ta6[[2]] <- update(ta6[[1]], subset = sf3$bigsmall == 1)
ta6[[3]] <- update(ta6[[1]], subset = sf3$bigsmall == 0)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr) + asinh(BInstr))
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(n) + asinh(BInstr))
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[2]] <- update(ta6[[1]], subset = sf3$bigsmall == 1)
ta6[[3]] <- update(ta6[[1]], subset = sf3$bigsmall == 0)
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[2]] <- update(ta6[[1]], subset = sf3$bigsmall == 1)
ta6[[3]] <- update(ta6[[1]], subset = sf3$bigsmall == 0)
ta[[1]] <- feols(dwsores ~ pppsores|FED + phase,
sf3,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta2[[1]] <- feols(dwbin_notest ~ pppsores| FED + phase,
#family = binomial(link = "logit"),
data = sf3, panel.id = c('RSSD','Date'))
ta2[[2]] <- update(ta2[[1]], . ~.
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta6 <- list()
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[2]] <- update(ta6[[1]], subset = sf3$bigsmall == 1)
ta6[[3]] <- update(ta6[[1]], subset = sf3$bigsmall == 0)
ta6[[4]] <- update(ta2[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[5]] <- update(ta6[[4]], subset = sf3$bigsmall == 1)
ta6[[6]] <- update(ta6[[4]], subset = sf3$bigsmall == 0)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
ta <- list()
ta[[1]] <- feols(dwsores ~ pppsores|FED + Date,
sf3,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta[[3]] <- update(ta[[1]], subset = sf3$bigsmall == 1)
ta[[4]] <- update(ta[[2]], subset =  sf3$bigsmall == 1)
ta[[5]] <- update(ta[[1]], subset =  sf3$bigsmall == 0)
ta[[6]] <- update(ta[[2]], subset =  sf3$bigsmall == 0)
ta2 <- list()
ta2[[1]] <- feols(dwbin_notest ~ pppsores| FED + Date,
#family = binomial(link = "logit"),
data = sf3, panel.id = c('RSSD','Date'))
ta2[[2]] <- update(ta2[[1]], . ~.
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta2[[3]] <- update(ta2[[1]], subset = sf3$bigsmall == 1)
ta2[[4]] <- update(ta2[[2]], subset = sf3$bigsmall == 1)
ta2[[5]] <- update(ta2[[1]], subset = sf3$bigsmall == 0)
ta2[[6]] <- update(ta2[[2]], subset = sf3$bigsmall == 0)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
#stargazer(data.frame(sf3[,c('PPP','PPPLF','PPPLF_i','DW','DW_i','reserve_asset_ratio','OFFICES','eqcaprat','precovdw')])) #summary statistic
dict1 <- c('dw_bin' = 'DW Prob', 'dwsores' = 'DW Borrowing/Reserves', 'reserve_asset_ratio' = 'RA Ratio',
'size' = 'Log Assets', 'log(PPPLF+1)' = 'Log(PPPLF)', 'log(RCON0010)' = 'Log(Reserves)',
'eqcaprat' = 'Equity Cap Ratio', 'pppsores' = 'PPP Lending/Reserves',
'pppsores x PPPLF_ind' = 'DS*PPPLF_ind', 'log(borr_total+1)' = 'Log(FF Borrowing)',
'log(pppsores)' = 'Log PPP share of Reserves', 'log(PPP)' = 'Log(PPP)',
'dwbin_notest' = 'DW Prob', 'log(reserve_asset_ratio)' = 'Log RA Ratio',
'log(LF_30)' = 'Log Borrowing from LF in last 30 Days', 'log(eqcaprat)' = 'Log Equity Cap Ratio',
'log(LF_30+1)' = 'Log Borrowing from LF in last 30 Days',
'log(dwsores+1)' = 'Log DW Borrowing',
'log(covexpo)' = 'COVID Exposure',  'bigsmall' = 'Size', 'log(pppsores+1)' = 'Log PPP Lending',
'bigsmall::0:log(pppsores+1)' = 'Demand*Small Banks', 'bigsmall::1:log(pppsores+1)' = 'Demand*Medium Banks',
'bigsmall::2:log(pppsores+1)' = 'Demand*Large Banks', 'log(DW_count+1)' = 'Log DW Borrowing Count', 'RSSD' = 'Bank',
'week' = 'Week', 'log(lsa)' = 'Log loan share of assets', 'log(dsa)' = 'Log deposit share of assets', 'log(rsa)' = 'Log reserve share of assets',
'log(eci)' = 'Economic exposure from branches', 'ci_com' = 'Unused CI comm/Assets', 'scisoa' = 'Small C&I loans/Assets',
'cdep' = 'Core deposits/Assets', 'cisoa' = 'C&I loans/Assets', 'liqass' = 'Liquid assets/Assets', 'levrat' = 'Tier 1 leverage ratio',
'log(dwage)' = 'log(Deposit-weighted average branch age)', 'covexpo' = 'Deposit-weighted new COVID rate',
'LF_30' = 'Borrowing from LF in last 30 Days', 'precovdw' = "Indicator if bank has used DW within 5 years pre-COVID", 'phase' = 'PPP Phase',
'rsa' = 'Reserve to Asset Ratio', 'log(OFFICES)' = 'Log # of Offices', 'eci' = 'Economic Impact')
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = FALSE)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = T)
ta6[[1]] <- update(ta[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[2]] <- update(ta6[[1]], subset = sf3$bigsmall == 1)
ta6[[3]] <- update(ta6[[1]], subset = sf3$bigsmall == 0)
ta6[[4]] <- update(ta2[[2]], .~. - pppsores | . | pppsores ~ asinh(c_instr))
ta6[[5]] <- update(ta6[[4]], subset = sf3$bigsmall == 1)
ta6[[6]] <- update(ta6[[4]], subset = sf3$bigsmall == 0)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = T)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = F)
etable(ta3, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
se = 'white',
label = 'aggregate_quant_reg',
headers = c('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
fitstat = ~n + r2,
tex = T)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = F)
etable(ta6, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing',
label = 'main_reg',
headers = c('Pooled', 'Large Banks','Small Banks'),
fitstat = ~ n + ivf + wh + sargan,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores')),
tex = T)
sft <- subset(sf3, dwsores > 0 & pppsores > 0)
ta[[1]] <- feols(dwsores ~ pppsores|FED + Date,
sft,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta[[3]] <- update(ta[[1]], subset = sf3$bigsmall == 1)
ta[[4]] <- update(ta[[2]], subset =  sf3$bigsmall == 1)
ta[[5]] <- update(ta[[1]], subset =  sf3$bigsmall == 0)
ta[[6]] <- update(ta[[2]], subset =  sf3$bigsmall == 0)
etable(ta, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing. Columns correspond to the same shares as Table 1. ',
label = 'main_reg',
headers = NA,
digits = 5,
fitstat = ~n + r2,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
#extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
ta[[3]] <- update(ta[[1]], subset = sft$bigsmall == 1)
ta[[4]] <- update(ta[[2]], subset =  sft$bigsmall == 1)
ta[[5]] <- update(ta[[1]], subset =  sft$bigsmall == 0)
ta[[6]] <- update(ta[[2]], subset =  sft$bigsmall == 0)
etable(ta, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing. Columns correspond to the same shares as Table 1. ',
label = 'main_reg',
headers = NA,
digits = 5,
fitstat = ~n + r2,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
#extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
ta[[1]] <- feols(dwsores ~ pppsores|RSSD + Date,
sft,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta[[3]] <- update(ta[[1]], subset = sft$bigsmall == 1)
ta[[4]] <- update(ta[[2]], subset =  sft$bigsmall == 1)
ta[[5]] <- update(ta[[1]], subset =  sft$bigsmall == 0)
ta[[6]] <- update(ta[[2]], subset =  sft$bigsmall == 0)
etable(ta, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing. Columns correspond to the same shares as Table 1. ',
label = 'main_reg',
headers = NA,
digits = 5,
fitstat = ~n + r2,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
#extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
ta[[1]] <- feols(dwsores ~ pppsores|RSSD,
sft,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta[[3]] <- update(ta[[1]], subset = sft$bigsmall == 1)
ta[[4]] <- update(ta[[2]], subset =  sft$bigsmall == 1)
ta[[5]] <- update(ta[[1]], subset =  sft$bigsmall == 0)
ta[[6]] <- update(ta[[2]], subset =  sft$bigsmall == 0)
etable(ta, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing. Columns correspond to the same shares as Table 1. ',
label = 'main_reg',
headers = NA,
digits = 5,
fitstat = ~n + r2,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
#extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
ta[[1]] <- feols(dwsores ~ pppsores|FED,
sft,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta[[3]] <- update(ta[[1]], subset = sft$bigsmall == 1)
ta[[4]] <- update(ta[[2]], subset =  sft$bigsmall == 1)
ta[[5]] <- update(ta[[1]], subset =  sft$bigsmall == 0)
ta[[6]] <- update(ta[[2]], subset =  sft$bigsmall == 0)
etable(ta, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing. Columns correspond to the same shares as Table 1. ',
label = 'main_reg',
headers = NA,
digits = 5,
fitstat = ~n + r2,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
#extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
ta[[1]] <- feols(dwsores ~ pppsores|FED + phase,
sft,
#subset = sf3$PPP>0 & sf3$DW > 0
panel.id = c('RSSD','Date'))
ta[[2]] <- update(ta[[1]], . ~ .
+ LF_30 + precovdw + log(OFFICES) + rsa + eqcaprat + eci +  ci_com + scisoa + cdep + cisoa + liqass + levrat + size +log(dwage) + covexpo)
ta[[3]] <- update(ta[[1]], subset = sft$bigsmall == 1)
ta[[4]] <- update(ta[[2]], subset =  sft$bigsmall == 1)
ta[[5]] <- update(ta[[1]], subset =  sft$bigsmall == 0)
ta[[6]] <- update(ta[[2]], subset =  sft$bigsmall == 0)
etable(ta, dict = dict1,
title = 'OLS Estimation of Log DW Borrowing. Columns correspond to the same shares as Table 1. ',
label = 'main_reg',
headers = NA,
digits = 5,
fitstat = ~n + r2,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
#extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
etable(ta2, dict = dict1,
title = 'Linear probability model estimation of DW borrowing probability. Column (1-2) is the pooled sample with and without controls, column (3-4) is for large banks that have assets greater than $600M, and columns (5-6) is for small community banks. The results from column (2) implies that a 10 percentage point increase in the PPP quantity loaned as a share of the reserves increases probability to borrow from the discount window by 1.6 percentage points. There seems to be a greater effect for large banks when shocked as compared to small banks.',
label = 'main_reg',
headers = NA,
digits = 4,
fitstat = ~n + r2,
group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
etable(ta2, dict = dict1,
title = 'Linear probability model estimation of DW borrowing probability. Column (1-2) is the pooled sample with and without controls, column (3-4) is for large banks that have assets greater than $600M, and columns (5-6) is for small community banks. The results from column (2) implies that a 10 percentage point increase in the PPP quantity loaned as a share of the reserves increases probability to borrow from the discount window by 1.6 percentage points. There seems to be a greater effect for large banks when shocked as compared to small banks.',
label = 'main_reg',
headers = NA,
digits = 4,
fitstat = ~n + r2,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = F)
etable(ta2, dict = dict1,
title = 'Linear probability model estimation of DW borrowing probability. Column (1-2) is the pooled sample with and without controls, column (3-4) is for large banks that have assets greater than $600M, and columns (5-6) is for small community banks. The results from column (2) implies that a 10 percentage point increase in the PPP quantity loaned as a share of the reserves increases probability to borrow from the discount window by 1.6 percentage points. There seems to be a greater effect for large banks when shocked as compared to small banks.',
label = 'main_reg',
headers = NA,
digits = 4,
fitstat = ~n + r2,
#group = list('Controls:'=c('lsa','rsa','dsa','Equity Cap Ratio','Log Assets','Log RA Ratio','econexpo','COVID Exposure','eci','npplsores','CI','C&I','COVID','Assets','OFFICES','age','Tier')),
extralines = list('Pooled','Pooled','Large Banks', 'Large Banks','Small Banks','Small Banks'),
tex = T)
